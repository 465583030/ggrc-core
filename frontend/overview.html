<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Overview &#8212; GGRC 0.10.35-Raspberry (5972f93) documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.10.35-Raspberry (5972f93)',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="GGRC 0.10.35-Raspberry (5972f93) documentation" href="../index.html" />
    <link rel="up" title="Frontend" href="index.html" />
    <link rel="next" title="View Models" href="models.html" />
    <link rel="prev" title="Frontend" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="View Models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Frontend"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">GGRC 0.10.35-Raspberry (5972f93) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Frontend</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>This document is a reference for anyone interested in understanding how
GGRC is constructed. The goal for this document is to explain how
everything works in moderate detail with references to source code which
can be used to understand in exact detail how GGRC works.</p>
<div class="section" id="client-side">
<h2>Client Side<a class="headerlink" href="#client-side" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The client-side of GGRC is initially constructed from templates and/or
views defined and rendered on the server. The templates and views
provide a scaffolding for the UI. Rendering those elements invokes
JavaScript code which bootstraps the majority of the client-side of GGRC
which is constructed from CanJS Controls, Components and Mustache templates.</p>
<p>Once the Controls are rendered, they take control of generating the
remainder of the UI and attaching all relevant logic and user
interaction handlers.</p>
<p>There are two main objects that are useful in managing the data model:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">GGRC</span></code></li>
<li><code class="docutils literal"><span class="pre">CMS</span></code></li>
</ul>
<p>For example, <code class="docutils literal"><span class="pre">GGRC.page_instance()</span></code> returns the current page instance,
and <code class="docutils literal"><span class="pre">GGRC.page_object</span></code> is the object rendered by the current page
(e.g. a Program), as it was received from the server (mapped objects are
stubs).</p>
<p><code class="docutils literal"><span class="pre">CMS.Models.&lt;MODEL&gt;.cache</span></code> stores the loaded objects. For example,
<code class="docutils literal"><span class="pre">CMS.Models.Program.cache</span></code> will have an array of all the loaded
programs.</p>
</div>
<div class="section" id="client-side-file-manifests">
<h3>Client-side File Manifests<a class="headerlink" href="#client-side-file-manifests" title="Permalink to this headline">¶</a></h3>
<p>Mustache templates need to be referenced
from a manifest file in order for it to be usable in constructing the
UI.</p>
<p>These manifest files live in <code class="docutils literal"><span class="pre">src/&lt;module&gt;/assets/assets.yaml</span></code>.</p>
<p>Javascript resources are bundled together using webpack.</p>
</div>
<div class="section" id="page-structure">
<h3>Page Structure<a class="headerlink" href="#page-structure" title="Permalink to this headline">¶</a></h3>
<div class="figure" id="id3">
<img alt="Page structure" src="../_images/page_structure.png" />
<p class="caption"><span class="caption-text">Page structure</span></p>
</div>
</div>
<div class="section" id="advanced-search">
<span id="id2"></span><h3>Advanced search<a class="headerlink" href="#advanced-search" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">Advanced</span> <span class="pre">Search</span></code> feature in GGRC provides a user simple way to perform
complicated search accross required data. The feature allows to search objects
both by attributes and mappings.
Search by attributes include possibility to find object by any attributes
it has with “Contains”, “Equals”, “Does not contain”, “Is not equal”,
“Lesser than”, “Greater than” attributes.
Search by mappings allows to search objects by any level of mappings
(for example, “I would like to find a Control that is mapped to Program A,
where Program A is mapped to Regulation B and etc.). User is also able to
construct complex group expression with “AND”, “OR” conditions
(for example, “I would like to find a Control that is mapped to Program A
AND that is mapped to Regulation B and etc.)
<code class="docutils literal"><span class="pre">Advanced</span> <span class="pre">Search</span></code> except tree view also integrated with Mapping and Global
search modals (<a class="reference internal" href="modals.html#mapping-and-global-search"><span class="std std-ref">Mapping and global search modals:</span></a>)
<code class="docutils literal"><span class="pre">Advanced</span> <span class="pre">Search</span></code> UI generate a complex query to <a class="reference internal" href="../backend/advanced_query_api.html#advanced-query-api"><span class="std std-ref">Advanced Query API</span></a>
in order to fetch data from server side.</p>
<div class="figure">
<img alt="../_images/advanced-search.png" src="../_images/advanced-search.png" />
</div>
</div>
<div class="section" id="quickformcontroller">
<h3>QuickFormController<a class="headerlink" href="#quickformcontroller" title="Permalink to this headline">¶</a></h3>
<p>This controller derives from the Modals controller in that it takes form
input, converts it into properties on model instances, and saves the
changes back to the server. A primary difference in QuickForm is that
any update to the instance triggered by QuickForm results in an
immediate save(). Also, QuickForm was created with the expectation that
the instance already exists on the server; attempts to work with new
model instances before first save may result in unexpected behavior.</p>
<ul class="simple">
<li>How do controllers interact with controls?</li>
<li>How do controllers interact with the backend?</li>
</ul>
</div>
<div class="section" id="view">
<h3>View<a class="headerlink" href="#view" title="Permalink to this headline">¶</a></h3>
<p>View templates are implemented all in JavaScript with the help of Mustache.</p>
</div>
<div class="section" id="components">
<h3>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h3>
<p>To build the UI are used components and are in the directory
<code class="docutils literal"><span class="pre">assets/javascripts/components</span></code></p>
<div class="section" id="standard-view-templates">
<h4>Standard view templates<a class="headerlink" href="#standard-view-templates" title="Permalink to this headline">¶</a></h4>
<p>Several standard view fragments are defined for each type of entity
within GGRC. Additional fragments can be created and utilized as needed.
But these templates are the main templates from which the majority of
the UI is created.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">info.mustache</span></code> - Defines the “Info” widget on each object’s page.
&nbsp;Defined per-widget in GGRC.Controllers.InfoWidget as the
<code class="docutils literal"><span class="pre">widget_view</span></code> option, and specified using <code class="docutils literal"><span class="pre">GGRC.WidgetList</span></code>
definitions.</li>
<li><code class="docutils literal"><span class="pre">extended_info.mustache</span></code> - Defines the content of an object’s
tooltip/popover in the LHN lists. &nbsp;Specified as the <code class="docutils literal"><span class="pre">tooltip_view</span></code>
parameter when rendering
<a class="reference external" href="https://github.com/google/ggrc-core/tree/dev/src/ggrc/assets/mustache/dashboard/lhn.mustache">src/ggrc/assets/mustache/dashboard/lhn.mustache</a>.</li>
<li><code class="docutils literal"><span class="pre">modal_content.mustache</span></code> - Defines the view for modal “create” or
“edit” form functionality. &nbsp;For most objects, this path is
automatically generated using the <code class="docutils literal"><span class="pre">data-template</span></code> or
<code class="docutils literal"><span class="pre">data-object-plural</span></code> attributes of the invoking element (see
<code class="docutils literal"><span class="pre">bootstrap/modal-ajax.js</span></code>.</li>
</ul>
</div>
<div class="section" id="where-to-find-view-templates">
<h4>Where to find view templates<a class="headerlink" href="#where-to-find-view-templates" title="Permalink to this headline">¶</a></h4>
<p>The view files are in the following folder within a module
<code class="docutils literal"><span class="pre">src/&lt;module&gt;/assets/mustache/</span></code>.</p>
<p>For example, the <code class="docutils literal"><span class="pre">ggrc_workflow</span></code> views are in the following folder
<a class="reference external" href="https://github.com/google/ggrc-core/tree/dev/src/ggrc_workflows/assets/mustache/">src/ggrc_workflows/assets/mustache/</a></p>
</div>
<div class="section" id="view-helpers">
<h4>View Helpers<a class="headerlink" href="#view-helpers" title="Permalink to this headline">¶</a></h4>
<p>View helpers are defined using the Mustache <a class="reference external" href="http://canjs.com/docs/can.mustache.Helpers.html">helper mechanism provided
by CanJS</a>. &nbsp;Core
helpers are specified in
<a class="reference external" href="https://github.com/google/ggrc-core/tree/dev/src/ggrc/assets/javascripts/mustache_helpers.js">src/ggrc/assets/javascripts/mustache_helpers.js</a>,
and extension helpers should be specified in a file named similar to
<code class="docutils literal"><span class="pre">src/&lt;module_name&gt;/assets/javascripts/&lt;class_name&gt;_mustache_helpers.js</span></code>.</p>
</div>
</div>
<div class="section" id="events">
<h3>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h3>
<p>Client-side event firing/handling is handled through CanJS, which is
primarily based on jQuery event handling.</p>
</div>
<div class="section" id="program-flow">
<h3>Program Flow<a class="headerlink" href="#program-flow" title="Permalink to this headline">¶</a></h3>
<p>Legacy part of client-side logic is implemented in Controls. Much of this logic is
implemented using asynchronous callbacks via
<a class="reference external" href="http://canjs.com/docs/can.Deferred.html">can.Deferred</a>.
All new features are written in component-based approach.</p>
</div>
<div class="section" id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h3>
<p>Most errors are reported to the system with a <code class="docutils literal"><span class="pre">window.onerror</span></code> handler
that generates flash messages at the top of the page and reports the
exception back to Tracker. For maximum coverage, the script that defines
this handler is inlined into base.haml.</p>
<p>AJAX failures that happen while a modal is active are reported back to a
flash handler at the modal level (so that the flash messages are not
covered by modals or overlays).</p>
<p>Because the error handler at the window level handles most of our needs,
try/catch blocks are rare in GGRC. However, it is worth noting that
errors in Deferred callbacks may not fire the onerror handler, <em>and</em>
&#8220;break the chain&#8221; inasmuch as the state of the deferred never changes
from &#8220;pending&#8221; after that, and other deferreds waiting for the result of
that deferred will never run. This is a failure of the jQuery Deferred
object to sensibly handle uncaught errors (they should reject the
deferred instead). In the case where it&#8217;s possible that a callback will
throw an error, it is recommended to wrap the content of the callback in
<code class="docutils literal"><span class="pre">try/catch</span></code> and return a rejected deferred when an error happens.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#client-side">Client Side</a><ul>
<li><a class="reference internal" href="#id1">Overview</a></li>
<li><a class="reference internal" href="#client-side-file-manifests">Client-side File Manifests</a></li>
<li><a class="reference internal" href="#page-structure">Page Structure</a></li>
<li><a class="reference internal" href="#advanced-search">Advanced search</a></li>
<li><a class="reference internal" href="#quickformcontroller">QuickFormController</a></li>
<li><a class="reference internal" href="#view">View</a></li>
<li><a class="reference internal" href="#components">Components</a><ul>
<li><a class="reference internal" href="#standard-view-templates">Standard view templates</a></li>
<li><a class="reference internal" href="#where-to-find-view-templates">Where to find view templates</a></li>
<li><a class="reference internal" href="#view-helpers">View Helpers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#events">Events</a></li>
<li><a class="reference internal" href="#program-flow">Program Flow</a></li>
<li><a class="reference internal" href="#error-handling">Error Handling</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Frontend</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="models.html"
                        title="next chapter">View Models</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/frontend/overview.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="models.html" title="View Models"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Frontend"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">GGRC 0.10.35-Raspberry (5972f93) documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Frontend</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Google Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>